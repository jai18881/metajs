<html>

	<!-- DEFINE FRAGMENT VIEW -->
	<template is="meta-view" name="com.example.itemList">

		<style>

			ul {
				list-style: none;
				padding: 0px;
				margin: 0px;
				border-top: 1px solid #dddddd;
			}
			
			li {
				cursor: pointer;
				padding: 8px;
				font-weight: 300;
				border-bottom: 1px solid #dddddd;
			}

			li:hover {
				background: #f3f3f3;
			}

			li[complete]{
				text-decoration: line-through;
				color: #999999;
			}

			li .remove {
				display: inline-block;
				float: right;
				color: #ff0000;
			}

			.empty {
				font-style: italic;
				color: #aaaaaa;
			}

		</style>

		<ul class="items">
			<li>
				<span class="remove">X</span>
				<strong class="task"></strong>
				<em class="date"></em>
			</li>
		</ul>

	</template>

	<!-- DEFINE FRAGMENT -->
	<script type="text/javascript">

		/*
		 * Register fragment
		 */
		Meta.Fragment('com.example.itemList', {

			view: 'com.example.itemList',

			model: {
				items: []
			},

			binding: {
				".items li": $__repeat("items", {
					"@": 		[
						$__attrIf("complete", "complete", true),
						$__prop("_model")
					],
					".task": 	"task",
					".date": 	$__fn(function(data){
						return data.date.getDate() + ". " + (data.date.getMonth() + 1) + ". " + data.date.getFullYear();
					})
				})
			},

			events: {

				"click .items li": function(ev){

					this.fragment.fireEvent("itemClick", {
						item: ev.sender._model
					})

				},

				"click .items li .remove": function(ev){

					this.fragment.fireEvent("itemRemove", {
						item: ev.sender.parentElement._model
					});

				}

			},

			setItems: function(items){

				this.model.items = items;
				this.render();

			}

		});

	</script>

</html>